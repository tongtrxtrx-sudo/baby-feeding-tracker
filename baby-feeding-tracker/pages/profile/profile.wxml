<view class="container">
  <view wx:if="{{!currentBaby && babies.length === 0}}" class="empty-state">
    <view class="empty-icon">
      <text style="font-size: 80rpx;">ğŸ‘¶</text>
    </view>
    <view class="empty-text">è¿˜æ²¡æœ‰å®å®æ¡£æ¡ˆ</view>
    <view class="empty-desc">æ·»åŠ ç¬¬ä¸€ä¸ªå®å®å¼€å§‹è®°å½•å§</view>
    <button class="add-btn btn-primary" bindtap="showAddModal">æ·»åŠ å®å®</button>
  </view>

  <view wx:if="{{currentBaby}}" class="current-baby-card card">
    <view class="welcome-decor decor-1"></view>
    <view class="welcome-decor decor-2"></view>
    <view class="welcome-decor decor-3"></view>
    <view class="baby-left">
      <view class="baby-text">
        <view class="baby-name">{{currentBaby.name}}</view>
        <view class="baby-detail">
          {{currentBaby.gender === 'boy' ? 'ç”·å®' : 'å¥³å®'}} Â· {{ageText}}
        </view>
      </view>
      <view class="baby-stats">
        <view class="stat-item">
          <view class="stat-value">{{currentBaby.birthWeight || '--'}}kg</view>
          <view class="stat-label">å‡ºç”Ÿä½“é‡</view>
        </view>
        <view class="stat-item">
          <view class="stat-value">{{currentBaby.birthHeight || '--'}}cm</view>
          <view class="stat-label">å‡ºç”Ÿèº«é«˜</view>
        </view>
        <view class="stat-item">
          <view class="stat-value">{{currentBaby.birthDate}}</view>
          <view class="stat-label">å‡ºç”Ÿæ—¥æœŸ</view>
        </view>
      </view>
    </view>
    <view class="baby-right">
      <view class="baby-avatar">ğŸ‘§</view>
    </view>
  </view>

  <view wx:if="{{babies.length > 0}}" class="section">
    <view class="section-header flex-between">
      <view class="section-title">å®å®åˆ—è¡¨</view>
      <button class="add-small-btn" bindtap="showAddModal">+ æ·»åŠ </button>
    </view>
    <view wx:for="{{babies}}" wx:key="id" class="baby-item card" bindtap="selectBaby" data-id="{{item.id}}">
      <view class="flex-between">
        <view class="baby-item-info">
          <view class="baby-item-name {{item.id === currentBaby.id ? 'active' : ''}}">
            <text style="font-size: 32rpx; margin-right: 8rpx;">{{item.gender === 'boy' ? 'ğŸ‘¦' : 'ğŸ‘§'}}</text>
            <text>{{item.name}}</text>
          </view>
          <view class="baby-item-detail text-secondary">{{item.birthDate}}</view>
        </view>
        <view class="baby-item-actions">
          <view wx:if="{{item.id === currentBaby.id}}" class="current-badge">å½“å‰</view>
          <view class="action-btns">
            <view class="action-btn edit" catchtap="editBaby" data-id="{{item.id}}">ç¼–è¾‘</view>
            <view class="action-btn delete" catchtap="deleteBaby" data-id="{{item.id}}">åˆ é™¤</view>
          </view>
        </view>
      </view>
    </view>
  </view>
</view>

<view wx:if="{{showModal}}" class="modal-mask" bindtap="hideModal">
  <view class="modal-content" catchtap="stopPropagation">
    <view class="modal-header">
      <view class="modal-title">{{editingBaby ? 'ç¼–è¾‘å®å®' : 'æ·»åŠ å®å®'}}</view>
      <view class="modal-close" bindtap="hideModal">
        <text style="font-size: 40rpx;">âœ•</text>
      </view>
    </view>
    <view class="modal-body">
      <view class="form-item">
        <view class="form-label">å®å®æ˜µç§°</view>
        <input class="form-input" placeholder="è¯·è¾“å…¥å®å®æ˜µç§°" value="{{formData.name}}" bindinput="onInput" data-field="name" />
      </view>
      <view class="form-item">
        <view class="form-label">æ€§åˆ«</view>
        <view class="gender-select flex">
          <view class="gender-option {{formData.gender === 'boy' ? 'active' : ''}}" bindtap="selectGender" data-gender="boy">
            <text style="font-size: 32rpx; margin-right: 8rpx;">ğŸ‘¦</text>
            <text>ç”·å®</text>
          </view>
          <view class="gender-option {{formData.gender === 'girl' ? 'active' : ''}}" bindtap="selectGender" data-gender="girl">
            <text style="font-size: 32rpx; margin-right: 8rpx;">ğŸ‘§</text>
            <text>å¥³å®</text>
          </view>
        </view>
      </view>
      <view class="form-item">
        <view class="form-label">å‡ºç”Ÿæ—¥æœŸ</view>
        <picker mode="date" value="{{formData.birthDate}}" bindchange="onDateChange">
          <view class="form-picker">{{formData.birthDate || 'è¯·é€‰æ‹©å‡ºç”Ÿæ—¥æœŸ'}}</view>
        </picker>
      </view>
      <view class="form-item">
        <view class="form-label">å‡ºç”Ÿä½“é‡(kg)</view>
        <input class="form-input" type="digit" placeholder="ä¾‹å¦‚: 3.3" value="{{formData.birthWeight}}" bindinput="onInput" data-field="birthWeight" />
      </view>
      <view class="form-item">
        <view class="form-label">å‡ºç”Ÿèº«é«˜(cm)</view>
        <input class="form-input" type="digit" placeholder="ä¾‹å¦‚: 50" value="{{formData.birthHeight}}" bindinput="onInput" data-field="birthHeight" />
      </view>
    </view>
    <view class="modal-footer flex">
      <button class="modal-btn btn-secondary" bindtap="hideModal">å–æ¶ˆ</button>
      <button class="modal-btn btn-primary" bindtap="saveBaby">ä¿å­˜</button>
    </view>
  </view>
</view>
